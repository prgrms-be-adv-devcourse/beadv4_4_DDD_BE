apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "mysql.fullname" . }}-slow-query-config
  labels:
    {{- include "mysql.labels" . | nindent 4 }}
data:
  slow-query.cnf: |
    [mysqld]
    # Slow query log 활성화
    slow_query_log = 1
    slow_query_log_file = {{ .Values.slowQuery.logFile | quote }}
    # 이 시간(초) 초과 쿼리만 기록
    long_query_time = {{ .Values.slowQuery.longQueryTime }}
    # 로그에 lock 대기 시간 포함 (선택)
    log_queries_not_using_indexes = 0